<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora NN Protect - Plan de Compensaci贸n</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo } = React;

        const Calculator = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="14"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></svg>;
        const Users = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>;
        const TrendingUp = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/></svg>;
        const Award = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="8" r="6"/><path d="M15.477 12.89 17 22l-5-3-5 3 1.523-9.11"/></svg>;

        const NNProtectCalculator = () => {
          const [directos, setDirectos] = useState(3);
          const [niveles, setNiveles] = useState(9);
          const [vn, setVn] = useState(100);
          const [vg, setVg] = useState(100);

          const rangos = [
            { nombre: 'Visionario', vgRequerido: 1465, unilevelNiveles: 3, infinito: 0 },
            { nombre: 'Emprendedor', vgRequerido: 21000, unilevelNiveles: 4, infinito: 0 },
            { nombre: 'Creativo', vgRequerido: 58000, unilevelNiveles: 5, infinito: 0 },
            { nombre: 'Innovador', vgRequerido: 120000, unilevelNiveles: 6, infinito: 0 },
            { nombre: 'Embajador Transformador', vgRequerido: 300000, unilevelNiveles: 9, infinito: 0.5 },
            { nombre: 'Embajador Inspirador', vgRequerido: 650000, unilevelNiveles: 9, infinito: 1.0 },
            { nombre: 'Embajador Consciente', vgRequerido: 1300000, unilevelNiveles: 9, infinito: 1.5 },
            { nombre: 'Embajador Solidario', vgRequerido: 2900000, unilevelNiveles: 9, infinito: 2.0 }
          ];

          const porcentajesUnilevel = [5, 8, 10, 10, 5, 4, 4, 3, 3];
          const porcentajesMatch = [30, 20, 10, 5];

          const calcularRango = (vgTotal) => {
            for (let i = rangos.length - 1; i >= 0; i--) {
              if (vgTotal >= rangos[i].vgRequerido) {
                return rangos[i];
              }
            }
            return { nombre: 'Sin Rango', vgRequerido: 0, unilevelNiveles: 0, infinito: 0 };
          };

          const calculos = useMemo(() => {
            const estructura = [];
            let vgTotalAcumulado = 0;
            
            for (let nivel = 1; nivel <= niveles; nivel++) {
              const personas = Math.pow(directos, nivel);
              const vgNivel = personas * vg;
              vgTotalAcumulado += vgNivel;
              estructura.push({ nivel, personas, vgNivel });
            }

            const miRango = calcularRango(vgTotalAcumulado);
            
            let bonoUnilevel = 0;
            const detalleUnilevel = [];
            
            for (let i = 0; i < Math.min(niveles, 9); i++) {
              const personas = estructura[i].personas;
              const porcentaje = porcentajesUnilevel[i];
              const comision = personas * vn * (porcentaje / 100);
              bonoUnilevel += comision;
              detalleUnilevel.push({
                nivel: i + 1,
                personas,
                porcentaje,
                comision
              });
            }

            let bonoInfinito = 0;
            const detalleInfinito = [];
            
            if (niveles > 9 && miRango.infinito > 0) {
              for (let i = 9; i < niveles; i++) {
                const personas = estructura[i].personas;
                
                let vgPorPersona = 0;
                for (let j = i; j < niveles; j++) {
                  vgPorPersona += Math.pow(directos, j - i) * vg;
                }
                
                const rangoPersona = calcularRango(vgPorPersona);
                const diferenciador = rangoPersona.infinito > 0 ? 
                  Math.max(0, miRango.infinito - rangoPersona.infinito) : 
                  miRango.infinito;
                
                const comision = personas * vn * (diferenciador / 100);
                bonoInfinito += comision;
                
                if (diferenciador > 0) {
                  detalleInfinito.push({
                    nivel: i + 1,
                    personas,
                    diferenciador,
                    comision
                  });
                }
              }
            }

            let bonoMatch = 0;
            const detalleMatch = [];
            
            const nivelesMatch = miRango.nombre === 'Embajador Transformador' ? 1 :
                                miRango.nombre === 'Embajador Inspirador' ? 2 :
                                miRango.nombre === 'Embajador Consciente' ? 3 :
                                miRango.nombre === 'Embajador Solidario' ? 4 : 0;

            for (let i = 0; i < Math.min(nivelesMatch, 4); i++) {
              const personas = estructura[i].personas;
              
              let vgEquipoPorPersona = vg;
              for (let j = i + 1; j < niveles; j++) {
                vgEquipoPorPersona += Math.pow(directos, j - i) * vg;
              }
              
              const rangoPersona = calcularRango(vgEquipoPorPersona);
              
              let bonoUnilevelPersona = 0;
              const nivelesDisponibles = Math.min(niveles - i - 1, rangoPersona.unilevelNiveles);
              
              for (let k = 0; k < nivelesDisponibles; k++) {
                const personasEnNivel = Math.pow(directos, k + 1);
                if (k < 9) {
                  bonoUnilevelPersona += personasEnNivel * vn * (porcentajesUnilevel[k] / 100);
                }
              }
              
              if (nivelesDisponibles > 9 && rangoPersona.infinito > 0) {
                for (let k = 9; k < nivelesDisponibles; k++) {
                  const personasEnNivel = Math.pow(directos, k + 1);
                  bonoUnilevelPersona += personasEnNivel * vn * (rangoPersona.infinito / 100);
                }
              }
              
              const porcentajeMatch = porcentajesMatch[i];
              const comisionMatch = personas * bonoUnilevelPersona * (porcentajeMatch / 100);
              bonoMatch += comisionMatch;
              
              detalleMatch.push({
                nivel: i + 1,
                personas,
                rangoPersona: rangoPersona.nombre,
                bonoUnilevelPersona,
                porcentajeMatch,
                comisionMatch
              });
            }

            return {
              estructura,
              vgTotal: vgTotalAcumulado,
              miRango,
              bonoUnilevel,
              detalleUnilevel,
              bonoInfinito,
              detalleInfinito,
              bonoMatch,
              detalleMatch,
              totalGanancias: bonoUnilevel + bonoInfinito + bonoMatch
            };
          }, [directos, niveles, vn, vg]);

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-blue-900 p-6">
              <div className="max-w-7xl mx-auto">
                <div className="text-center mb-8">
                  <h1 className="text-4xl font-bold text-white mb-2 flex items-center justify-center gap-3">
                    <Calculator />
                    Calculadora NN Protect
                  </h1>
                  <p className="text-blue-200">Plan de Compensaci贸n - Simulador de Ganancias</p>
                </div>

                <div className="bg-white rounded-xl shadow-2xl p-6 mb-6">
                  <h2 className="text-2xl font-bold text-gray-800 mb-4">Par谩metros de Simulaci贸n</h2>
                  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div>
                      <label className="block text-sm font-semibold text-gray-700 mb-2">
                        Directos (Nivel 1)
                      </label>
                      <input
                        type="number"
                        min="1"
                        max="20"
                        value={directos}
                        onChange={(e) => setDirectos(parseInt(e.target.value) || 1)}
                        className="w-full px-4 py-3 border-2 border-blue-300 rounded-lg focus:border-blue-500 focus:outline-none text-lg font-semibold"
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-semibold text-gray-700 mb-2">
                        Niveles de Profundidad
                      </label>
                      <input
                        type="number"
                        min="1"
                        max="15"
                        value={niveles}
                        onChange={(e) => setNiveles(parseInt(e.target.value) || 1)}
                        className="w-full px-4 py-3 border-2 border-blue-300 rounded-lg focus:border-blue-500 focus:outline-none text-lg font-semibold"
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-semibold text-gray-700 mb-2">
                        VN por Miembro
                      </label>
                      <input
                        type="number"
                        min="0"
                        step="10"
                        value={vn}
                        onChange={(e) => setVn(parseFloat(e.target.value) || 0)}
                        className="w-full px-4 py-3 border-2 border-green-300 rounded-lg focus:border-green-500 focus:outline-none text-lg font-semibold"
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-semibold text-gray-700 mb-2">
                        VG por Miembro
                      </label>
                      <input
                        type="number"
                        min="0"
                        step="10"
                        value={vg}
                        onChange={(e) => setVg(parseFloat(e.target.value) || 0)}
                        className="w-full px-4 py-3 border-2 border-purple-300 rounded-lg focus:border-purple-500 focus:outline-none text-lg font-semibold"
                      />
                    </div>
                  </div>
                </div>

                <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                  <div className="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-xl p-6 text-white">
                    <div className="flex items-center gap-3 mb-2">
                      <Users />
                      <h3 className="text-lg font-semibold">Total Equipo</h3>
                    </div>
                    <p className="text-4xl font-bold">
                      {calculos.estructura.reduce((sum, n) => sum + n.personas, 0).toLocaleString()}
                    </p>
                    <p className="text-blue-100 text-sm mt-1">personas en tu red</p>
                  </div>

                  <div className="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl shadow-xl p-6 text-white">
                    <div className="flex items-center gap-3 mb-2">
                      <TrendingUp />
                      <h3 className="text-lg font-semibold">Volumen Total (VG)</h3>
                    </div>
                    <p className="text-4xl font-bold">
                      {calculos.vgTotal.toLocaleString()}
                    </p>
                    <p className="text-purple-100 text-sm mt-1">volumen de grupo</p>
                  </div>

                  <div className="bg-gradient-to-br from-yellow-500 to-orange-500 rounded-xl shadow-xl p-6 text-white">
                    <div className="flex items-center gap-3 mb-2">
                      <Award />
                      <h3 className="text-lg font-semibold">Tu Rango</h3>
                    </div>
                    <p className="text-3xl font-bold">
                      {calculos.miRango.nombre}
                    </p>
                    <p className="text-orange-100 text-sm mt-1">rango calificado</p>
                  </div>
                </div>

                <div className="bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl shadow-2xl p-8 mb-6 text-white">
                  <h2 className="text-3xl font-bold mb-4 text-center"> GANANCIAS TOTALES</h2>
                  <div className="text-center">
                    <p className="text-6xl font-bold mb-2">
                      ${calculos.totalGanancias.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}
                    </p>
                    <div className="flex justify-center gap-8 mt-4 text-sm">
                      <div>
                        <p className="text-green-100">Bono Unilevel</p>
                        <p className="font-semibold text-xl">${calculos.bonoUnilevel.toLocaleString(undefined, {minimumFractionDigits: 2})}</p>
                      </div>
                      <div>
                        <p className="text-green-100">Bono Infinito</p>
                        <p className="font-semibold text-xl">${calculos.bonoInfinito.toLocaleString(undefined, {minimumFractionDigits: 2})}</p>
                      </div>
                      <div>
                        <p className="text-green-100">Bono Match</p>
                        <p className="font-semibold text-xl">${calculos.bonoMatch.toLocaleString(undefined, {minimumFractionDigits: 2})}</p>
                      </div>
                    </div>
                  </div>
                </div>

                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  <div className="bg-white rounded-xl shadow-xl p-6">
                    <h3 className="text-2xl font-bold text-gray-800 mb-4 border-b-2 border-blue-500 pb-2">
                       Bono Unilevel (Niveles 1-9)
                    </h3>
                    <div className="space-y-2 max-h-96 overflow-y-auto">
                      {calculos.detalleUnilevel.map((det) => (
                        <div key={det.nivel} className="flex justify-between items-center bg-blue-50 p-3 rounded-lg">
                          <div>
                            <span className="font-semibold text-gray-700">Nivel {det.nivel}</span>
                            <span className="text-sm text-gray-500 ml-2">({det.personas.toLocaleString()} personas)</span>
                          </div>
                          <div className="text-right">
                            <p className="text-sm text-gray-600">{det.porcentaje}%</p>
                            <p className="font-bold text-blue-600">${det.comision.toLocaleString(undefined, {minimumFractionDigits: 2})}</p>
                          </div>
                        </div>
                      ))}
                    </div>
                    <div className="mt-4 pt-4 border-t-2 border-gray-200">
                      <div className="flex justify-between items-center">
                        <span className="font-bold text-lg">Subtotal Unilevel:</span>
                        <span className="font-bold text-2xl text-blue-600">
                          ${calculos.bonoUnilevel.toLocaleString(undefined, {minimumFractionDigits: 2})}
                        </span>
                      </div>
                    </div>
                  </div>

                  <div className="bg-white rounded-xl shadow-xl p-6">
                    <h3 className="text-2xl font-bold text-gray-800 mb-4 border-b-2 border-purple-500 pb-2">
                      撅 Bono Infinito (Nivel 10+)
                    </h3>
                    {calculos.detalleInfinito.length > 0 ? (
                      <>
                        <div className="space-y-2 max-h-96 overflow-y-auto">
                          {calculos.detalleInfinito.map((det) => (
                            <div key={det.nivel} className="flex justify-between items-center bg-purple-50 p-3 rounded-lg">
                              <div>
                                <span className="font-semibold text-gray-700">Nivel {det.nivel}</span>
                                <span className="text-sm text-gray-500 ml-2">({det.personas.toLocaleString()} personas)</span>
                              </div>
                              <div className="text-right">
                                <p className="text-sm text-gray-600">{det.diferenciador}%</p>
                                <p className="font-bold text-purple-600">${det.comision.toLocaleString(undefined, {minimumFractionDigits: 2})}</p>
                              </div>
                            </div>
                          ))}
                        </div>
                        <div className="mt-4 pt-4 border-t-2 border-gray-200">
                          <div className="flex justify-between items-center">
                            <span className="font-bold text-lg">Subtotal Infinito:</span>
                            <span className="font-bold text-2xl text-purple-600">
                              ${calculos.bonoInfinito.toLocaleString(undefined, {minimumFractionDigits: 2})}
                            </span>
                          </div>
                        </div>
                      </>
                    ) : (
                      <p className="text-gray-500 text-center py-8">
                        {niveles <= 9 ? 'Necesitas m谩s de 9 niveles para acceder al Bono Infinito' : 
                         'Necesitas alcanzar rango Embajador para acceder al Bono Infinito'}
                      </p>
                    )}
                  </div>

                  <div className="bg-white rounded-xl shadow-xl p-6 lg:col-span-2">
                    <h3 className="text-2xl font-bold text-gray-800 mb-4 border-b-2 border-green-500 pb-2">
                       Bono Match (Igualaci贸n)
                    </h3>
                    {calculos.detalleMatch.length > 0 ? (
                      <>
                        <div className="space-y-3 max-h-96 overflow-y-auto">
                          {calculos.detalleMatch.map((det) => (
                            <div key={det.nivel} className="bg-green-50 p-4 rounded-lg">
                              <div className="flex justify-between items-start mb-2">
                                <div>
                                  <span className="font-semibold text-gray-700 text-lg">Nivel {det.nivel}</span>
                                  <span className="text-sm text-gray-500 ml-2">({det.personas.toLocaleString()} personas)</span>
                                </div>
                                <div className="text-right">
                                  <p className="text-sm text-gray-600">Match: {det.porcentajeMatch}%</p>
                                  <p className="font-bold text-xl text-green-600">
                                    ${det.comisionMatch.toLocaleString(undefined, {minimumFractionDigits: 2})}
                                  </p>
                                </div>
                              </div>
                              <div className="text-sm text-gray-600 flex justify-between items-center bg-white p-2 rounded">
                                <span>Rango: <span className="font-semibold">{det.rangoPersona}</span></span>
                                <span>Unilevel c/u: <span className="font-semibold">${det.bonoUnilevelPersona.toLocaleString(undefined, {minimumFractionDigits: 2})}</span></span>
                              </div>
                            </div>
                          ))}
                        </div>
                        <div className="mt-4 pt-4 border-t-2 border-gray-200">
                          <div className="flex justify-between items-center">
                            <span className="font-bold text-lg">Subtotal Match:</span>
                            <span className="font-bold text-2xl text-green-600">
                              ${calculos.bonoMatch.toLocaleString(undefined, {minimumFractionDigits: 2})}
                            </span>
                          </div>
                        </div>
                      </>
                    ) : (
                      <p className="text-gray-500 text-center py-8">
                        Necesitas alcanzar rango Embajador Transformador o superior para acceder al Bono Match
                      </p>
                    )}
                  </div>
                </div>

                <div className="bg-white rounded-xl shadow-xl p-6 mt-6">
                  <h3 className="text-2xl font-bold text-gray-800 mb-4 border-b-2 border-blue-500 pb-2">
                     Estructura del Equipo
                  </h3>
                  <div className="overflow-x-auto">
                    <table className="w-full">
                      <thead>
                        <tr className="bg-blue-100">
                          <th className="px-4 py-3 text-left font-semibold">Nivel</th>
                          <th className="px-4 py-3 text-right font-semibold">Personas</th>
                          <th className="px-4 py-3 text-right font-semibold">VG del Nivel</th>
                          <th className="px-4 py-3 text-right font-semibold">VG Acumulado</th>
                        </tr>
                      </thead>
                      <tbody>
                        {calculos.estructura.map((est, idx) => {
                          const vgAcum = calculos.estructura.slice(0, idx + 1).reduce((sum, e) => sum + e.vgNivel, 0);
                          return (
                            <tr key={est.nivel} className="border-b hover:bg-gray-50">
                              <td className="px-4 py-3 font-semibold">{est.nivel}</td>
                              <td className="px-4 py-3 text-right">{est.personas.toLocaleString()}</td>
                              <td className="px-4 py-3 text-right">{est.vgNivel.toLocaleString()}</td>
                              <td className="px-4 py-3 text-right font-semibold text-blue-600">{vgAcum.toLocaleString()}</td>
                            </tr>
                          );
                        })}
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          );
        };

        ReactDOM.render(<NNProtectCalculator />, document.getElementById('root'));
    </script>
</body>
</html>